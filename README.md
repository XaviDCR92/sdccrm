# sdccrm

## What is sdccrm?
sdcc is a dead code optimization tool for the stm8 port of sdcc that removes unused functions. By configuring an entry point, sdccrm creates a function call tree and determines which labels can be optimized away.

## Why this tool?
Unfortunately, as of sdcc-3.9.0, unused functions are not removed by the optimizer. After reading its source code thoroughly and being under time pressure, it seemed like a good idea to implement a separate tool for this.

## How does it work?
sdccrm takes one or more .asm files, which are usually generated by sdcc when using the -S (assemble, no compile) switch. Then, it takes a user-defined entry point ("_main" is assumed by default unless indicated otherwise) and generates a function call tree. All unused labels are removed away from the .asm file so sdcc can now compile these optimized .asm files seamlessly, while optimizing MCU memory usage.

## Why is this optimization not done by the compiler?
Sincerely, I have no idea - I guess sdcc being essentially an open-source, community-driven effort might lack some more development. However, I needed this optimization as I was partly using a third-part API which included many functions that I did not need. I just cannot find acceptable these unused functions are not optimzed away, as it took more than half of the microcontroller memory.

# License
Similarly to sdcc, sdccrm is licensed under GPLv3.

# Known issues
Removing unused declarations and definitions will surely give problems when --debug switch is used by sdcc, as debugging symbols need to point to those now-unexisting labels.
